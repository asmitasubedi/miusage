(()=>{"use strict";const e=window.wp.blocks,t=window.wp.i18n;function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},a.apply(this,arguments)}const l=window.wp.element,s=window.wp.blockEditor,n=window.wp.components,i=e=>{const{attributes:a,setAttributes:i}=e,{showTitle:c,showId:m,showFname:o,showLname:r,showEmail:d,showDate:u}=a,h=[{name:"showTitle",label:(0,t.__)("Show Title","miusage"),checked:c},{name:"showId",label:(0,t.__)("Show ID","miusage"),checked:m},{name:"showFname",label:(0,t.__)("Show First Name","miusage"),checked:o},{name:"showLname",label:(0,t.__)("Show Last Name","miusage"),checked:r},{name:"showEmail",label:(0,t.__)("Show Email","miusage"),checked:d},{name:"showDate",label:(0,t.__)("Show Date","miusage"),checked:u}];return(0,l.createElement)(s.InspectorControls,null,(0,l.createElement)(n.PanelBody,{title:(0,t.__)("Toggle Settings","miusage"),initialOpen:!0},h?.map(((e,t)=>(0,l.createElement)(n.ToggleControl,{key:t,label:e.label,checked:e.checked,onChange:()=>{i({[e.name]:!e.checked})}})))))},c=window.wp.date;[{title:(0,t.__)("Misuage Challenges","miusage"),description:(0,t.__)("Misuage Challenges","miusage"),icon:"rest-api",namespace:"challenges",keywords:[(0,t.__)("Misuage Challenges","miusage"),(0,t.__)("Miusage","miusage")],component:e=>{const{attributes:m,setAttributes:o,className:r,isSelected:d,clientId:u}=e,{showTitle:h,showId:w,showFname:g,showLname:b,showEmail:_,showDate:p}=m,[E,k]=(0,l.useState)([]),[y,S]=(0,l.useState)([]),[f,j]=(0,l.useState)([]),v=(0,s.useBlockProps)(),O={id:w,fname:g,lname:b,email:_,date:p};(0,l.useEffect)((()=>{(async()=>{const e=await fetch(`${miusage.siteURL}/wp-json/miusage/v1/challenges`),t=await e.json(),a=Object.values(t?.data?.rows);let l=Object.values(t?.data?.headers);l=Object.keys(a[0]).map(((e,t)=>({[e]:l[t]}))),j(a),S(l),k(t?.title)})()}),[]);const N=(0,c.__experimentalGetSettings)().formats.date;return(0,l.createElement)("div",a({className:r},v),(0,l.createElement)(i,{attributes:m,setAttributes:o,className:r,isSelected:d}),(0,l.createElement)(n.Disabled,null,(0,l.createElement)("div",{className:"miusage-challenge-data"},(0,l.createElement)("table",{className:"miusage-challenge-data-table"},h&&E&&(0,l.createElement)("caption",null,E),(0,l.createElement)("thead",null,(0,l.createElement)("tr",null,y.map(((e,t)=>{let a=O[Object.keys(e)],s=Object.values(e);if(a)return(0,l.createElement)("th",{key:t},s)})))),(0,l.createElement)("tbody",null,f.map(((e,a)=>(0,l.createElement)("tr",{key:a},w&&(0,l.createElement)("td",{"data-label":(0,t.__)("Id","miusage")},e.id),g&&(0,l.createElement)("td",{"data-label":(0,t.__)("First Name","miusage")},e.fname),b&&(0,l.createElement)("td",{"data-label":(0,t.__)("Last Name","miusage")},e.lname),_&&(0,l.createElement)("td",{"data-label":(0,t.__)("Email","miusage")},e.email),p&&(0,l.createElement)("td",{"data-label":(0,t.__)("Date","miusage")},(0,c.dateI18n)(N,1e3*e.date))))))))),0===f.length&&(0,l.createElement)(n.Spinner,null))}}].forEach((t=>{(0,e.registerBlockType)(`miusage/${t.namespace}`,{title:t.title,description:t.description,icon:t.icon,category:"miusage",keywords:[...t.keywords],example:{attributes:{}},edit:t.component,save:()=>null})}))})();